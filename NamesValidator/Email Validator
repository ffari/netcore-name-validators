 namespace Validate
 {
    public partial class Authentication : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void Button1_Click(object sender, EventArgs e)
        {
            if (AuthenticateUser(TextBox1.Text, TextBox2.Text))
            {
                FormsAuthentication.RedirectFromLoginPage(TextBox1.Text, false);
            }
            else
            {
                Label1.Text = "Wrong Credentials pls try again";
                Label1.Visible = true;
            }
        }

        private bool AuthenticateUser(string email, string password)
        {
            string CS = ConfigurationManager.ConnectionStrings["npuntu"].ConnectionString;
            
                using (SqlConnection con = new SqlConnection(CS))
                {
                    SqlCommand cmd = new SqlCommand("spAuthenticateUser", con);
                    cmd.CommandType = CommandType.StoredProcedure;

                    SqlParameter PEmail = new SqlParameter("@Email", email);
                    SqlParameter PPassword = new SqlParameter("@password", password);

                    cmd.Parameters.Add(PEmail);
                    cmd.Parameters.Add(PPassword);

                    con.Open();
                    int ReturnCode = (int)cmd.ExecuteScalar();
                    return ReturnCode == 1;
               }
        }
    }
}
